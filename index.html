
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Clipboard Layout Editor (Heading only on box)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        *{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI',system-ui,sans-serif;}
        body{background:#f3f4f6;min-height:100vh;}
        .container{display:flex;height:100vh;padding:10px;gap:10px;}

        /* LEFT PANEL + TOGGLE */
        .add-panel-wrapper{position:relative;transition:width .25s;}
        .add-panel{width:260px;background:#fff;border-radius:8px;padding:15px;box-shadow:0 2px 8px rgba(0,0,0,0.1);height:100%;display:flex;flex-direction:column;}
        .add-panel.collapsed{width:0;padding:0;overflow:hidden;box-shadow:none;}
        .collapse-toggle{position:absolute;top:10px;right:-16px;width:16px;height:60px;background:#111827;color:#fff;border-radius:0 6px 6px 0;display:flex;align-items:center;justify-content:center;font-size:10px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.3);z-index:5;}
        .collapse-toggle i{transition:transform .25s;}
        .collapsed + .collapse-toggle i{transform:rotate(180deg);}

        .panel-title{display:flex;align-items:center;gap:6px;margin-bottom:8px;font-size:1rem;font-weight:600;}
        .mode-label{font-size:0.75rem;color:#6b7280;margin-bottom:6px;}
        label{display:block;margin-bottom:4px;font-size:0.8rem;font-weight:600;color:#4b5563;}
        input[type="text"]{width:100%;border-radius:6px;border:2px solid #e5e7eb;padding:6px 8px;font-size:13px;margin-bottom:6px;}
        input[type="text"]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 2px rgba(99,102,241,0.2);}
        textarea{width:100%;height:70px;border-radius:6px;border:2px solid #e5e7eb;padding:8px;font-size:13px;resize:vertical;}
        textarea:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 2px rgba(99,102,241,0.2);}
        .color-options{display:grid;grid-template-columns:repeat(6,1fr);gap:6px;margin-bottom:8px;}
        .color-option{width:26px;height:26px;border-radius:6px;cursor:pointer;border:2px solid transparent;}
        .color-option.selected{border-color:#111827;}
        .custom-color{display:flex;align-items:center;gap:6px;margin-bottom:8px;}
        .custom-color input[type="color"]{width:40px;height:28px;border-radius:6px;border:none;cursor:pointer;}
        .btn{background:linear-gradient(to right,#6366f1,#4f46e5);border:none;color:#fff;padding:7px 9px;border-radius:6px;font-size:13px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:6px;margin-bottom:6px;}
        .btn.secondary{background:#e5e7eb;color:#111827;}
        .quick-buttons{display:grid;grid-template-columns:repeat(2,1fr);gap:6px;}
        .quick-btn{background:#f9fafb;border:1px solid #e5e7eb;font-size:11px;padding:5px 3px;border-radius:5px;cursor:pointer;}
        .hint{margin-top:6px;font-size:0.75rem;color:#6b7280;}
        .edit-info{font-size:0.75rem;color:#10b981;margin-bottom:4px;}

        /* BOARD (no header now) */
        .board{flex:1;background:#fff;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1);position:relative;overflow:hidden;}

        /* BOXES */
        .clipboard-item{
            position:absolute;
            min-width:100px;
            min-height:40px;
            width:140px;
            height:60px;
            border-radius:6px;
            padding:6px 8px;
            cursor:move;
            display:flex;
            align-items:center;
            justify-content:flex-start;
            color:#fff;
            font-size:12px;
            font-weight:600;
            box-shadow:0 2px 6px rgba(0,0,0,0.15);
            user-select:none;
        }
        .clipboard-item.selected{outline:2px solid #facc15;}
        .item-heading{
            max-width:100%;
            white-space:nowrap;
            overflow:hidden;
            text-overflow:ellipsis;
        }
        .resize-handle{position:absolute;width:10px;height:10px;right:2px;bottom:2px;background:rgba(0,0,0,0.4);border-radius:2px;cursor:se-resize;}
        .delete-btn{position:absolute;right:2px;top:2px;width:18px;height:18px;border-radius:50%;border:none;font-size:10px;background:rgba(0,0,0,0.4);color:#fff;cursor:pointer;}
        .copy-indicator{position:absolute;left:4px;top:4px;padding:2px 4px;border-radius:3px;background:rgba(16,185,129,0.9);color:#fff;font-size:9px;opacity:0;transition:opacity .2s;}
        .clipboard-item.copied .copy-indicator{opacity:1;}

        .notification{position:fixed;right:20px;bottom:20px;background:#10b981;color:#fff;padding:8px 12px;border-radius:6px;font-size:0.85rem;display:flex;gap:6px;align-items:center;box-shadow:0 2px 8px rgba(0,0,0,0.2);opacity:0;transform:translateY(100px);transition:all .3s;z-index:100;}
        .notification.show{opacity:1;transform:translateY(0);}
    </style>
</head>
<body>
<div class="container">
    <!-- LEFT PANEL -->
    <div class="add-panel-wrapper">
        <div class="add-panel" id="addPanel">
            <div class="panel-title">
                <i class="fas fa-layer-group"></i><span>Box Editor</span>
            </div>
            <div class="mode-label" id="modeLabel">Mode: Add new</div>
            <div class="edit-info" id="editInfo" style="display:none;">
                Editing box ID: <span id="editIdSpan"></span>
            </div>

            <label for="headingInput">Heading (shown on box)</label>
            <input type="text" id="headingInput" placeholder="e.g. Gmail Login">

            <label for="contentInput">Content (copied to clipboard)</label>
            <textarea id="contentInput" placeholder="Actual text / password / code..."></textarea>

            <label style="margin-top:8px;">Background color</label>
            <div class="color-options" id="colorOptions">
                <div class="color-option selected" style="background:#3b82f6" data-color="#3b82f6"></div>
                <div class="color-option" style="background:#ef4444" data-color="#ef4444"></div>
                <div class="color-option" style="background:#f97316" data-color="#f97316"></div>
                <div class="color-option" style="background:#22c55e" data-color="#22c55e"></div>
                <div class="color-option" style="background:#eab308" data-color="#eab308"></div>
                <div class="color-option" style="background:#6366f1" data-color="#6366f1"></div>
            </div>
            <div class="custom-color">
                <input type="color" id="customColor" value="#3b82f6">
                <span style="font-size:0.8rem;color:#6b7280;">Custom</span>
            </div>

            <button class="btn" id="addBtn"><i class="fas fa-plus"></i>Add new box</button>
            <button class="btn secondary" id="updateBtn" disabled>
                <i class="fas fa-pen"></i>Update selected box
            </button>

            <div class="hint">
                Only <strong>content</strong> is copied when you click a box; heading is just for identifying the box.
            </div>

            <div style="margin-top:10px;border-top:1px solid #e5e7eb;padding-top:8px;">
                <div style="font-size:0.8rem;margin-bottom:6px;color:#6b7280;">Quick add (heading + content)</div>
                <div class="quick-buttons">
                    <button class="quick-btn" data-heading="Email" data-content="user@email.com">
                        Email
                    </button>
                    <button class="quick-btn" data-heading="API Key" data-content="API_KEY_123">
                        API
                    </button>
                    <button class="quick-btn" data-heading="Password" data-content="Pass@123">
                        Password
                    </button>
                    <button class="quick-btn" data-heading="Phone" data-content="+123456789">
                        Phone
                    </button>
                </div>
            </div>
        </div>

        <div class="collapse-toggle" id="collapseToggle">
            <i class="fas fa-angle-left"></i>
        </div>
    </div>

    <!-- BOARD (no header) -->
    <div class="board" id="board"></div>
</div>

<div class="notification" id="notification">
    <i class="fas fa-check-circle"></i><span id="notificationText">Copied</span>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const board = document.getElementById('board');
    const headingInput = document.getElementById('headingInput');
    const contentInput = document.getElementById('contentInput');
    const addBtn = document.getElementById('addBtn');
    const updateBtn = document.getElementById('updateBtn');
    const colorOptions = document.querySelectorAll('.color-option');
    const customColor = document.getElementById('customColor');
    const quickButtons = document.querySelectorAll('.quick-btn');
    const notification = document.getElementById('notification');
    const notificationText = document.getElementById('notificationText');
    const modeLabel = document.getElementById('modeLabel');
    const editInfo = document.getElementById('editInfo');
    const editIdSpan = document.getElementById('editIdSpan');
    const addPanel = document.getElementById('addPanel');
    const collapseToggle = document.getElementById('collapseToggle');

    let selectedColor = '#3b82f6';
    // items: id, heading, content, color, x,y,w,h
    let items = JSON.parse(localStorage.getItem('clipboardLayoutV2') || '[]');
    let selectedId = null;

    function saveLayout(){
        localStorage.setItem('clipboardLayoutV2', JSON.stringify(items));
    }

    function showNotification(msg,type='success'){
        const colors={
            success:'#10b981',
            error:'#ef4444',
            info:'#3b82f6',
            warning:'#f59e0b'
        };
        notification.style.backgroundColor = colors[type] || colors.success;
        notificationText.textContent = msg;
        notification.classList.add('show');
        setTimeout(()=>notification.classList.remove('show'),1500);
    }

    function escapeHtml(text){
        const div=document.createElement('div');
        div.textContent=text;
        return div.innerHTML;
    }

    function clearSelection(){
        document.querySelectorAll('.clipboard-item').forEach(el=>el.classList.remove('selected'));
        selectedId = null;
        updateBtn.disabled = true;
        modeLabel.textContent = 'Mode: Add new';
        editInfo.style.display = 'none';
        editIdSpan.textContent = '';
    }

    function renderItems(){
        document.querySelectorAll('.clipboard-item').forEach(el=>el.remove());

        items.forEach(item=>{
            const el=document.createElement('div');
            el.className='clipboard-item';
            el.dataset.id=item.id;
            el.style.backgroundColor=item.color;
            el.style.left=item.x+'px';
            el.style.top=item.y+'px';
            el.style.width=item.w+'px';
            el.style.height=item.h+'px';

            el.innerHTML=`
                <div class="copy-indicator">Copied</div>
                <button class="delete-btn"><i class="fas fa-times"></i></button>
                <div class="item-heading">${escapeHtml(item.heading || '')}</div>
                <div class="resize-handle"></div>
            `;
            if(item.id===selectedId) el.classList.add('selected');

            board.appendChild(el);
            attachDrag(el,item.id);
            attachResize(el,item.id);

            // click â†’ select + copy CONTENT ONLY
            el.addEventListener('click',(e)=>{
                if (e.target.closest('.delete-btn') || e.target.closest('.resize-handle')) return;

                selectedId = item.id;
                document.querySelectorAll('.clipboard-item').forEach(b=>b.classList.remove('selected'));
                el.classList.add('selected');
                loadItemIntoEditor(item);

                navigator.clipboard.writeText(item.content || '').then(()=>{
                    el.classList.add('copied');
                    showNotification('Content copied','success');
                    setTimeout(()=>el.classList.remove('copied'),700);
                }).catch(()=>showNotification('Copy failed','error'));
            });

            // delete
            el.querySelector('.delete-btn').addEventListener('click',(e)=>{
                e.stopPropagation();
                items = items.filter(it=>it.id!==item.id);
                saveLayout();
                if(selectedId===item.id) clearSelection();
                renderItems();
                showNotification('Item deleted','info');
            });
        });
    }

    function loadItemIntoEditor(item){
        headingInput.value = item.heading || '';
        contentInput.value = item.content || '';
        selectedColor = item.color;
        customColor.value = item.color;
        colorOptions.forEach(o=>{
            o.classList.toggle('selected', o.dataset.color===item.color);
        });
        modeLabel.textContent = 'Mode: Edit selected';
        editInfo.style.display='block';
        editIdSpan.textContent = item.id;
        updateBtn.disabled=false;
    }

    function attachDrag(element,id){
        let offsetX,offsetY,dragging=false;

        element.addEventListener('mousedown',e=>{
            if (e.target.closest('.resize-handle') || e.target.closest('.delete-btn')) return;
            dragging=true;
            const rect=element.getBoundingClientRect();
            offsetX=e.clientX-rect.left;
            offsetY=e.clientY-rect.top;
            element.style.zIndex=10;
        });

        document.addEventListener('mousemove',e=>{
            if(!dragging) return;
            const boardRect=board.getBoundingClientRect();
            let x=e.clientX-boardRect.left-offsetX;
            let y=e.clientY-boardRect.top-offsetY;
            if(x<0)x=0;
            if(y<0)y=0;
            element.style.left=x+'px';
            element.style.top=y+'px';
        });

        document.addEventListener('mouseup',()=>{
            if(!dragging) return;
            dragging=false;
            element.style.zIndex='';
            const idx=items.findIndex(it=>it.id===id);
            if(idx!==-1){
                const rect=element.getBoundingClientRect();
                const bRect=board.getBoundingClientRect();
                items[idx].x=rect.left-bRect.left;
                items[idx].y=rect.top-bRect.top;
                saveLayout();
            }
        });
    }

    function attachResize(element,id){
        const handle=element.querySelector('.resize-handle');
        let startX,startY,startW,startH,resizing=false;

        handle.addEventListener('mousedown',e=>{
            e.stopPropagation();
            resizing=true;
            const rect=element.getBoundingClientRect();
            startX=e.clientX;
            startY=e.clientY;
            startW=rect.width;
            startH=rect.height;
        });

        document.addEventListener('mousemove',e=>{
            if(!resizing) return;
            let w=startW+(e.clientX-startX);
            let h=startH+(e.clientY-startY);
            if(w<100)w=100;
            if(h<40)h=40;
            element.style.width=w+'px';
            element.style.height=h+'px';
        });

        document.addEventListener('mouseup',()=>{
            if(!resizing) return;
            resizing=false;
            const idx=items.findIndex(it=>it.id===id);
            if(idx!==-1){
                const rect=element.getBoundingClientRect();
                items[idx].w=rect.width;
                items[idx].h=rect.height;
                saveLayout();
            }
        });
    }

    function addItem(heading,content){
        if(!content.trim()){
            showNotification('Enter content (what to copy)','warning');
            return;
        }
        const boardRect=board.getBoundingClientRect();
        const id=Date.now();
        const item={
            id,
            heading: heading && heading.trim() ? heading.trim() : content.slice(0,20),
            content: content,
            color:selectedColor,
            x:20+(items.length*10)%(Math.max(boardRect.width-160,160)),
            y:20+(items.length*10)%120,
            w:140,
            h:60
        };
        items.push(item);
        saveLayout();
        clearSelection();
        renderItems();
        headingInput.value='';
        contentInput.value='';
        contentInput.focus();
    }

    function updateSelectedItem(){
        if(!selectedId){
            showNotification('Select a box to edit','warning');
            return;
        }
        const idx=items.findIndex(it=>it.id===selectedId);
        if(idx===-1) return;
        const newHeading = headingInput.value.trim();
        items[idx].heading = newHeading || items[idx].heading;
        items[idx].content = contentInput.value;
        items[idx].color = selectedColor;
        saveLayout();
        renderItems();
        showNotification('Box updated','success');
    }

    // COLOR HANDLING
    colorOptions.forEach(opt=>{
        opt.addEventListener('click',()=>{
            colorOptions.forEach(o=>o.classList.remove('selected'));
            opt.classList.add('selected');
            selectedColor=opt.dataset.color;
            customColor.value=selectedColor;
        });
    });
    customColor.addEventListener('change',e=>{
        selectedColor=e.target.value;
        colorOptions.forEach(o=>o.classList.remove('selected'));
    });

    // BUTTONS
    addBtn.addEventListener('click',()=>addItem(headingInput.value,contentInput.value));
    contentInput.addEventListener('keydown',e=>{
        if((e.ctrlKey||e.metaKey)&&e.key==='Enter') addItem(headingInput.value,contentInput.value);
    });
    updateBtn.addEventListener('click',updateSelectedItem);

    quickButtons.forEach(btn=>{
        btn.addEventListener('click',()=>{
            addItem(btn.dataset.heading,btn.dataset.content);
        });
    });

    // CLEAR ALL: keep for convenience (Ctrl+Shift+R etc. not needed)
    document.addEventListener('keydown',(e)=>{
        if(e.ctrlKey && e.shiftKey && e.key.toLowerCase()==='x'){
            if(!items.length) return;
            if(confirm(`Delete all ${items.length} items?`)){
                items=[];
                saveLayout();
                clearSelection();
                renderItems();
            }
        }
    });

    // COLLAPSE PANEL
    collapseToggle.addEventListener('click',()=>{
        addPanel.classList.toggle('collapsed');
    });

    // INITIAL RENDER
    renderItems();
});
</script>
</body>
</html>
